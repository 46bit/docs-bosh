# DNS

With services being distributed across many VMs, BOSH provides a DNS server which supports local resolution of BOSH addresses. These addresses are typically generated by Director via [job links](../../links.md) when they are consuming a service dependency (e.g. a database). In addition to taking responsibility for converting hostnames to IP addresses, the BOSH DNS server implements basic health checking to support returning only IPs which are known to be healthy.

The DNS server is designed to run locally on VMs, however it is not pre-installed on the stemcell like the [agent](agent.md) is. Typically the DNS service is configured via [runtime config](../../runtime-config.md) ([example](https://github.com/cloudfoundry/bosh-deployment/blob/master/runtime-configs/dns.yml)) which ensures the `bosh-dns` job is installed on every VM.

In addition to a DNS server running on the VM, it also has a component to relay


## Service Dependencies


### Host Records

Because BOSH approaches the problem in a fully distributed, fault tolerant manner, the DNS server assumes it can find a copy of VM profiles on the local machine. The [agent](agent.md) is responsible for managing and updating the file (`/var/vcap/instance/dns/records.json`) and the DNS server reloads its host configuration whenever there are changes.


### Recursors

When the DNS server receives a query for a non-BOSH hostname, it will forward those requests to remote recursors. By default, the recursors configured by the operating system will be used. Alternatively, they can be explicitly defined when configuring the `bosh-dns` job.


### Remote Healthiness

In order to support limiting DNS responses to healthy IPs, 


## Additional Resources

 * [cloudfoundry/bosh-dns-release](https://github.com/cloudfoundry/bosh-dns-release) - source code
